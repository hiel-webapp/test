<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TrendScope (MVP) â€” ìµœì‹  íŠ¸ë Œë“œ ì°¾ì•„ì„œ ë³´ì—¬ì£¼ê¸°</title>
  <style>
    :root{
      --bg:#0b0f19;
      --panel:#101828;
      --panel2:#0f172a;
      --text:#e6eaf2;
      --muted:#a7b0c0;
      --line:rgba(255,255,255,.09);
      --chip:#0b1220;
      --chipLine:rgba(255,255,255,.12);
      --accent:#7c3aed;
      --accent2:#22c55e;
      --warn:#f59e0b;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --radius2:22px;
      --focus: 0 0 0 3px rgba(124,58,237,.25);
      color-scheme: dark;
    }
    [data-theme="light"]{
      --bg:#f6f7fb;
      --panel:#ffffff;
      --panel2:#ffffff;
      --text:#0b1220;
      --muted:#556074;
      --line:rgba(10,18,32,.10);
      --chip:#f3f5fb;
      --chipLine:rgba(10,18,32,.12);
      --shadow: 0 10px 30px rgba(16,24,40,.12);
      --focus: 0 0 0 3px rgba(124,58,237,.20);
      color-scheme: light;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "ë§‘ì€ ê³ ë”•";
      background: radial-gradient(1200px 500px at 15% 0%, rgba(124,58,237,.18), transparent 50%),
                  radial-gradient(1000px 500px at 85% 10%, rgba(34,197,94,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      letter-spacing:-0.2px;
    }
    a{ color:inherit; text-decoration:none; }
    button, input, select{ font:inherit; }
    .wrap{ max-width:1200px; margin:0 auto; padding:22px; }

    /* Header */
    header{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(10px);
      background: color-mix(in oklab, var(--bg), transparent 35%);
      border-bottom:1px solid var(--line);
    }
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:14px;
      padding:14px 22px;
      max-width:1200px; margin:0 auto;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      min-width: 220px;
    }
    .logo{
      width:36px; height:36px; border-radius:12px;
      background: linear-gradient(135deg, var(--accent), #06b6d4);
      box-shadow: 0 10px 25px rgba(124,58,237,.25);
    }
    .brand h1{
      font-size:16px; margin:0; line-height:1.15;
      font-weight:800;
    }
    .brand .sub{
      display:block; font-size:12px; color:var(--muted); font-weight:600;
      margin-top:2px;
    }

    .actions{ display:flex; align-items:center; gap:10px; }
    .btn{
      border:1px solid var(--line);
      background: color-mix(in oklab, var(--panel), transparent 0%);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      box-shadow: none;
      transition: transform .08s ease, border-color .15s ease, background .15s ease;
    }
    .btn:hover{ border-color: color-mix(in oklab, var(--line), var(--accent) 25%); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      border-color: color-mix(in oklab, var(--accent), white 10%);
      background: linear-gradient(135deg, color-mix(in oklab, var(--accent), white 6%), color-mix(in oklab, #06b6d4, white 4%));
      color:white;
      font-weight:800;
    }
    .btn.ghost{
      background: transparent;
    }

    /* Layout */
    .hero{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      margin-top:18px;
    }
    @media (max-width: 980px){
      .hero{ grid-template-columns:1fr; }
      .brand{ min-width:auto; }
    }

    .panel{
      border:1px solid var(--line);
      background: color-mix(in oklab, var(--panel), transparent 0%);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
    }
    .panel .hd{
      padding:16px 16px 10px 16px;
      display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
      border-bottom:1px solid var(--line);
    }
    .panel .hd h2{
      margin:0;
      font-size:16px;
      font-weight:900;
      letter-spacing:-0.3px;
    }
    .panel .hd p{
      margin:6px 0 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.45;
      font-weight:600;
    }
    .panel .bd{ padding:14px 16px 16px; }

    /* Filters */
    .filters{
      display:grid;
      grid-template-columns: 1.1fr .9fr .9fr;
      gap:10px;
      margin-top:12px;
    }
    @media (max-width: 980px){
      .filters{ grid-template-columns:1fr; }
    }
    .field label{
      display:block;
      font-size:12px; font-weight:900;
      color: var(--muted);
      margin:0 0 6px 2px;
    }
    .control{
      width:100%;
      padding:11px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background: color-mix(in oklab, var(--panel2), transparent 0%);
      color:var(--text);
      outline:none;
      transition: box-shadow .15s ease, border-color .15s ease;
    }
    .control:focus{
      box-shadow: var(--focus);
      border-color: color-mix(in oklab, var(--accent), var(--line) 35%);
    }

    .chips{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:12px;
    }
    .chip{
      padding:9px 10px;
      border-radius:999px;
      border:1px solid var(--chipLine);
      background: var(--chip);
      font-size:12px;
      font-weight:900;
      color: color-mix(in oklab, var(--text), var(--muted) 12%);
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, border-color .15s ease, background .15s ease;
    }
    .chip:hover{ border-color: color-mix(in oklab, var(--accent), var(--chipLine) 55%); }
    .chip:active{ transform: translateY(1px); }
    .chip[data-active="true"]{
      border-color: color-mix(in oklab, var(--accent), white 10%);
      background: color-mix(in oklab, var(--accent), black 65%);
      color:white;
    }

    /* Cards */
    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
    }
    @media (max-width: 980px){ .grid{ grid-template-columns:1fr; } }
    .card{
      border:1px solid var(--line);
      background: color-mix(in oklab, var(--panel2), transparent 0%);
      border-radius: var(--radius);
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      transition: transform .10s ease, border-color .15s ease;
      cursor:pointer;
    }
    .card:hover{
      transform: translateY(-2px);
      border-color: color-mix(in oklab, var(--accent), var(--line) 55%);
    }
    .meta{
      display:flex; flex-wrap:wrap; gap:8px;
      align-items:center;
    }
    .pill{
      font-size:11px; font-weight:900;
      padding:6px 9px;
      border-radius:999px;
      border:1px solid var(--line);
      color: var(--muted);
      background: transparent;
    }
    .pill.hot{
      border-color: color-mix(in oklab, var(--warn), white 15%);
      color: color-mix(in oklab, var(--warn), white 5%);
    }
    .pill.ai{
      border-color: color-mix(in oklab, var(--accent2), white 12%);
      color: color-mix(in oklab, var(--accent2), white 5%);
    }
    .card h3{
      margin:0;
      font-size:15px;
      font-weight:950;
      line-height:1.25;
    }
    .desc{
      margin:0;
      color: var(--muted);
      font-size:13px;
      line-height:1.45;
      font-weight:650;
      display:-webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }
    .row{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      margin-top:auto;
      padding-top:6px;
    }
    .score{
      font-weight:1000;
      font-size:12px;
      color: color-mix(in oklab, var(--text), var(--accent) 15%);
    }
    .miniBtns{ display:flex; gap:8px; }
    .mini{
      padding:8px 10px;
      border-radius:12px;
      font-size:12px;
      font-weight:900;
      border:1px solid var(--line);
      background: transparent;
      cursor:pointer;
    }
    .mini.primary{
      border-color: color-mix(in oklab, var(--accent), white 10%);
      background: color-mix(in oklab, var(--accent), black 65%);
      color:white;
    }

    /* Sections */
    .sectionTitle{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      margin:18px 2px 10px;
    }
    .sectionTitle h2{
      margin:0;
      font-size:15px;
      font-weight:1000;
    }
    .sectionTitle .hint{
      margin:0;
      font-size:12px;
      color:var(--muted);
      font-weight:700;
    }

    /* Modal */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modalBack[data-open="true"]{ display:flex; }
    .modal{
      width:min(860px, 100%);
      border-radius: 24px;
      border:1px solid var(--line);
      background: var(--panel);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modal .mh{
      padding:14px 16px;
      display:flex; justify-content:space-between; align-items:center; gap:12px;
      border-bottom:1px solid var(--line);
    }
    .modal .mh h3{
      margin:0;
      font-size:16px;
      font-weight:1000;
      line-height:1.25;
    }
    .modal .mb{
      padding:14px 16px 16px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
    }
    @media (max-width: 980px){
      .modal .mb{ grid-template-columns:1fr; }
    }
    .kv{
      display:grid;
      gap:10px;
    }
    .kv .k{
      font-size:12px; color:var(--muted); font-weight:900;
      margin-bottom:2px;
    }
    .kv .v{
      font-size:13px; font-weight:800; line-height:1.55;
    }
    .list{
      margin:0;
      padding-left:18px;
      color: var(--muted);
      font-size:13px;
      font-weight:700;
      line-height:1.6;
    }
    .linkBox{
      border:1px solid var(--line);
      border-radius: 16px;
      padding:12px;
      background: color-mix(in oklab, var(--panel2), transparent 0%);
    }
    .linkBox a{
      display:block;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      margin-top:10px;
      font-weight:900;
      font-size:13px;
      background: transparent;
      transition: border-color .15s ease, transform .08s ease;
    }
    .linkBox a:hover{ border-color: color-mix(in oklab, var(--accent), var(--line) 55%); }
    .linkBox a:active{ transform: translateY(1px); }

    .footer{
      margin:20px 0 8px;
      color:var(--muted);
      font-size:12px;
      font-weight:650;
      text-align:center;
    }
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: transparent;
      font-weight:900;
      font-size:12px;
      color:var(--muted);
    }
  </style>
</head>

<body>
<header>
  <div class="topbar">
    <div class="brand" role="banner" aria-label="TrendScope">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>TrendScope <span class="sub">ì „ ì„¸ê³„ ìµœì‹  íŠ¸ë Œë“œ íƒìƒ‰ (MVP)</span></h1>
      </div>
    </div>

    <div class="actions">
      <button class="btn ghost" id="btnRefresh" title="ìƒ˜í”Œ ë°ì´í„° ìƒˆë¡œ ì„ê¸°">ìƒˆë¡œê³ ì¹¨</button>
      <button class="btn" id="btnTheme" title="ë‹¤í¬/ë¼ì´íŠ¸ ì „í™˜">í…Œë§ˆ ì „í™˜</button>
      <button class="btn primary" id="btnAbout" title="MVP ì•ˆë‚´">MVP ì•ˆë‚´</button>
    </div>
  </div>
</header>

<main class="wrap">
  <section class="hero">
    <div class="panel">
      <div class="hd">
        <div>
          <h2>ì˜¤ëŠ˜ì˜ í•«í•œ íŠ¸ë Œë“œ</h2>
          <p>ì¹´í…Œê³ ë¦¬Â·êµ­ê°€Â·ì§€ì—­ í•„í„°ë¡œ â€œì§€ê¸ˆ ëœ¨ëŠ” ê²ƒâ€ì„ ë¹ ë¥´ê²Œ í›‘ì–´ë³´ëŠ” í™”ë©´ì…ë‹ˆë‹¤. (í˜„ì¬ëŠ” ìƒ˜í”Œ ë°ì´í„°)</p>
        </div>
        <div class="badge" title="MVP ë²„ì „">
          <span aria-hidden="true">âš¡</span> MVP v0.1
        </div>
      </div>
      <div class="bd">
        <div class="filters" aria-label="í•„í„°">
          <div class="field">
            <label for="search">í‚¤ì›Œë“œ</label>
            <input id="search" class="control" placeholder="ì˜ˆ: í¬ë¡œì…°, ë§ì°¨, ëŸ¬ë‹, K-POPâ€¦" />
          </div>
          <div class="field">
            <label for="country">êµ­ê°€</label>
            <select id="country" class="control"></select>
          </div>
          <div class="field">
            <label for="region">ì§€ì—­</label>
            <select id="region" class="control"></select>
          </div>
        </div>

        <div class="chips" id="categoryChips" aria-label="ì¹´í…Œê³ ë¦¬ ì„ íƒ"></div>
      </div>
    </div>

    <div class="panel">
      <div class="hd">
        <div>
          <h2>AI ì¶”ì²œ (ê°€ì§œ ë¡œì§)</h2>
          <p>ì‹¤ì œ MVPì—ì„œëŠ” ì—¬ê¸°ë§Œ â€œí¬ë¡¤ë§/ì†Œì…œ íŠ¸ë Œë“œ/LLM ìš”ì•½â€ìœ¼ë¡œ ëŒ€ì²´í•˜ë©´ ë©ë‹ˆë‹¤.</p>
        </div>
      </div>
      <div class="bd">
        <div id="aiPickGrid" class="grid" aria-label="AI ì¶”ì²œ ì¹´ë“œ"></div>
      </div>
    </div>
  </section>

  <section>
    <div class="sectionTitle">
      <h2>ì „ì²´ íŠ¸ë Œë“œ í”¼ë“œ</h2>
      <p class="hint">ìµœê·¼ ë°˜ì‘ ì ìˆ˜(ê°€ìƒ) ê¸°ë°˜ ì •ë ¬ Â· í•„í„° ì ìš©</p>
    </div>
    <div id="feedGrid" class="grid" aria-label="íŠ¸ë Œë“œ í”¼ë“œ"></div>
  </section>

  <div class="footer">
    ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” <b>êµ­ê°€ë³„ íŠ¸ë Œë“œ ìˆ˜ì§‘(ë‰´ìŠ¤/SNS/ì»¤ë®¤ë‹ˆí‹°)</b> â†’ <b>ìš”ì•½/ë¶„ë¥˜</b> â†’ <b>ì¶”ì²œ/ë­í‚¹</b> íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ êµì²´í•˜ì„¸ìš”.
  </div>
</main>

<!-- Modal -->
<div class="modalBack" id="modalBack" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="mh">
      <h3 id="modalTitle">ìƒì„¸</h3>
      <button class="btn" id="btnClose">ë‹«ê¸°</button>
    </div>
    <div class="mb">
      <div class="kv">
        <div>
          <div class="k">í•œì¤„ ì†Œê°œ</div>
          <div class="v" id="mIntro">-</div>
        </div>
        <div>
          <div class="k">ì™œ ëœ¨ëŠ”ê°€ (ìš”ì•½)</div>
          <div class="v" id="mWhy">-</div>
        </div>
        <div>
          <div class="k">ì†Œë¹„/ì¦ê¸°ëŠ” ë°©ë²•</div>
          <ul class="list" id="mHow"></ul>
        </div>
      </div>

      <div class="linkBox">
        <div class="k">ë©”íƒ€</div>
        <div class="v" id="mMeta">-</div>
        <a href="#" target="_blank" rel="noopener" id="mBuy">êµ¬ë§¤/ì°¸ê³  ë§í¬ ì—´ê¸°</a>
        <a href="#" target="_blank" rel="noopener" id="mLearn">ë” ì•Œì•„ë³´ê¸°(ê²€ìƒ‰)</a>
        <div style="margin-top:10px; color:var(--muted); font-size:12px; font-weight:700; line-height:1.45;">
          â€» MVPì—ì„œëŠ” ë§í¬ê°€ ìƒ˜í”Œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹¤ì œì—ì„  ì‡¼í•‘/ì§€ë„/ê³µì‹ ì‚¬ì´íŠ¸/ë¦¬ë·°ë¡œ ì—°ê²°í•˜ì„¸ìš”.
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  /**
   * TrendScope MVP (Single-file)
   * - í˜„ì¬ëŠ” mock ë°ì´í„° + ê°„ë‹¨ ì¶”ì²œ/í•„í„° ë¡œì§
   * - ë‚˜ì¤‘ì— APIë¡œ êµì²´: fetchTrends(), fetchCountries(), fetchRegions(), aiPick()
   */

  const CATEGORIES = [
    { key: "all", label: "ì „ì²´" },
    { key: "fashion", label: "íŒ¨ì…˜" },
    { key: "accessory", label: "ì†Œí’ˆ" },
    { key: "food", label: "ìŒì‹" },
    { key: "dessert", label: "ë””ì €íŠ¸" },
    { key: "culture", label: "ë¬¸í™”/ë†€ì´" },
    { key: "music", label: "ìŒì•…" },
    { key: "sports", label: "ìŠ¤í¬ì¸ " },
  ];

  // ìƒ˜í”Œ ë°ì´í„°(ê°€ìƒ)
  // score: í˜„ì¬ ë°˜ì‘/ë²„ì¦ˆ(0~100), updatedAt: ìµœì‹ ì„± í‘œì‹œìš©
  let trends = [
    {
      id: "t1",
      title: "Korea: ì•½ê³¼ ì•„ì´ìŠ¤í¬ë¦¼(ë‰´íŠ¸ë¡œ í•œê³¼ ë””ì €íŠ¸)",
      category: "dessert",
      country: "ëŒ€í•œë¯¼êµ­",
      region: "ì„œìš¸",
      intro: "ì•½ê³¼ë¥¼ ì•„ì´ìŠ¤í¬ë¦¼/íŒŒë¥´í˜ í† í•‘ìœ¼ë¡œ ì˜¬ë ¤ â€˜ë‰´íŠ¸ë¡œ+ë‹¬ë‹¬â€™ ì¡°í•©ìœ¼ë¡œ ì†Œë¹„.",
      why: "ì „í†µ ê°„ì‹ì˜ ì¬í•´ì„ + SNS ì¸ì¦ ì»·(í…ìŠ¤ì²˜/ë¹„ì£¼ì–¼) + ì¹´í˜ í™•ì‚°.",
      how: ["ì¹´í˜ ì‹œê·¸ë‹ˆì²˜ ë©”ë‰´ë¡œ ë§›ë³´ê¸°", "ì•½ê³¼/ì•„ì´ìŠ¤í¬ë¦¼ DIY ì¡°í•©", "ì„ ë¬¼ìš© í•œê³¼ íŒ¨í‚¤ì§€ë¡œ í™•ì¥"],
      buyUrl: "https://search.naver.com/search.naver?query=%EC%95%BD%EA%B3%BC+%EC%95%84%EC%9D%B4%EC%8A%A4%ED%81%AC%EB%A6%BC",
      score: 86,
      updatedAt: daysAgo(2),
    },
    {
      id: "t2",
      title: "Japan: ë§ì°¨ í¼ ë¼ë–¼ + ë””ì €íŠ¸ í˜ì–´ë§",
      category: "food",
      country: "ì¼ë³¸",
      region: "ë„ì¿„",
      intro: "ë§ì°¨(æŠ¹èŒ¶) ìŒë£Œì— í¼/í¬ë¦¼ì„ ë”í•˜ê³  ë””ì €íŠ¸ì™€ ì„¸íŠ¸ë¡œ ì¦ê¸°ëŠ” íŠ¸ë Œë“œ.",
      why: "ì›°ë¹™/ì“´ë§› ì„ í˜¸ + ê°ê°ì  ì¹´í˜ ì—°ì¶œ + ê´€ê´‘ ìˆ˜ìš”.",
      how: ["ë§ì°¨ ë¼ë–¼/í¼ ë¼ë–¼ ì£¼ë¬¸", "ë§ì°¨ í‹°ë¼ë¯¸ìˆ˜/ë¡¤ì¼€ì´í¬ì™€ í˜ì–´ë§", "ë§ì°¨ ì „ë¬¸ ì¹´í˜ íˆ¬ì–´"],
      buyUrl: "https://www.google.com/search?q=tokyo+matcha+foam+latte",
      score: 79,
      updatedAt: daysAgo(5),
    },
    {
      id: "t3",
      title: "USA: ëŸ¬ë‹ ì½”ì–´(Run-core) íŒ¨ì…˜",
      category: "fashion",
      country: "ë¯¸êµ­",
      region: "ë‰´ìš•",
      intro: "ëŸ¬ë‹ì›¨ì–´ë¥¼ ì¼ìƒë³µìœ¼ë¡œ ë¯¹ìŠ¤(ìœˆë“œë¸Œë ˆì´ì»¤, ìˆì¸ , ëŸ¬ë‹í™”, ê¸°ëŠ¥ì„± ì†Œì¬).",
      why: "ëŸ¬ë‹/í•˜í”„ ë§ˆë¼í†¤ ë¶ + ì• ìŠ¬ë ˆì € ì§€ì† + ê¸°ëŠ¥ì„±/ì‹¤ìš©ì„±.",
      how: ["ëŸ¬ë‹í™”+í…Œí¬ì›¨ì–´ ë¯¹ìŠ¤", "ì›Œí‚¹/ëŸ¬ë‹ ì»¤ë®¤ë‹ˆí‹° ì°¸ì—¬", "ë ˆì´ìŠ¤ ì´ë²¤íŠ¸ ìº˜ë¦°ë” í™•ì¸"],
      buyUrl: "https://www.google.com/search?q=run+core+fashion",
      score: 82,
      updatedAt: daysAgo(3),
    },
    {
      id: "t4",
      title: "France: ë°”ê²ŒíŠ¸ ìƒŒë“œ(ìŠ¤íŠ¸ë¦¬íŠ¸ ìŠ¤íƒ€ì¼)",
      category: "food",
      country: "í”„ë‘ìŠ¤",
      region: "íŒŒë¦¬",
      intro: "ë°”ê²ŒíŠ¸ì— ë‹¤ì–‘í•œ ì†ì¬ë£Œë¥¼ ë„£ì–´ â€˜ê°€ë³ê²Œ ë“¤ê³  ë¨¹ëŠ”â€™ ìŠ¤íŠ¸ë¦¬íŠ¸ í‘¸ë“œë¡œ ì¬ì£¼ëª©.",
      why: "ê°„í¸ì‹ + ë¡œì»¬ ê°ì„± + ê´€ê´‘ê° ì†Œë¹„ íŒ¨í„´.",
      how: ["ë™ë„¤ ë¶€ë‘ì£¼ë¦¬ ìƒŒë“œìœ„ì¹˜ êµ¬ë§¤", "ì¹˜ì¦ˆ/í–„/ì±„ì†Œ í´ë˜ì‹ ì¡°í•©", "í”¼í¬ë‹‰ ë¬¸í™”ì™€ ê²°í•©"],
      buyUrl: "https://www.google.com/search?q=paris+baguette+sandwich+trend",
      score: 71,
      updatedAt: daysAgo(7),
    },
    {
      id: "t5",
      title: "Thailand: ë§ê³  ì°¹ìŒ€ + ì•„ì´ìŠ¤ ë¯¹ìŠ¤ ë””ì €íŠ¸",
      category: "dessert",
      country: "íƒœêµ­",
      region: "ë°©ì½•",
      intro: "ë§ê³  ì°¹ìŒ€ì„ ì•„ì´ìŠ¤/ë¹™ìˆ˜ í˜•íƒœë¡œ í™•ì¥í•´ ë” ì‹œì›í•˜ê³  ì‚¬ì§„ ì˜ ë‚˜ì˜¤ê²Œ ë³€í˜•.",
      why: "ì—´ëŒ€ ê³¼ì¼ ì‹œì¦Œì„± + ìŠ¤íŠ¸ë¦¬íŠ¸ ë””ì €íŠ¸ í™•ì‚° + ì‡¼ì¸  ë°”ì´ëŸ´.",
      how: ["ì•¼ì‹œì¥/ë””ì €íŠ¸ìƒµ ë°©ë¬¸", "ì½”ì½”ë„› ì†ŒìŠ¤/í† í•‘ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ", "í…Œì´í¬ì•„ì›ƒ í›„ ì¸ì¦ìƒ·"],
      buyUrl: "https://www.google.com/search?q=bangkok+mango+sticky+rice+ice+dessert",
      score: 77,
      updatedAt: daysAgo(4),
    },
    {
      id: "t6",
      title: "UK: ì¶•êµ¬ ë°ˆ(ê²½ê¸° í›„ ë¦¬ì•¡ì…˜ í´ë¦½)",
      category: "sports",
      country: "ì˜êµ­",
      region: "ëŸ°ë˜",
      intro: "ê²½ê¸° ì§í›„ ì¸í„°ë·°/íŒ¬ ë¦¬ì•¡ì…˜/ì§§ì€ í´ë¦½ì´ ë°ˆìœ¼ë¡œ ì¬ê°€ê³µë˜ì–´ í™•ì‚°.",
      why: "ê²½ê¸° ì´ë²¤íŠ¸ì„± + ìˆí¼ í”Œë«í¼ í™•ì‚° + ì»¤ë®¤ë‹ˆí‹° 2ì°¨ ì°½ì‘.",
      how: ["ê²½ê¸° í•˜ì´ë¼ì´íŠ¸+ë¦¬ì•¡ì…˜ ë³´ê¸°", "íŒ¬ ì»¤ë®¤ë‹ˆí‹° ë°ˆ íƒìƒ‰", "ìë§‰/í¸ì§‘ìœ¼ë¡œ 2ì°¨ ì œì‘"],
      buyUrl: "https://www.google.com/search?q=football+reaction+clips+meme",
      score: 74,
      updatedAt: daysAgo(6),
    },
    {
      id: "t7",
      title: "Korea: í¬í† ë¶€ìŠ¤ ê°ì„± ì†Œí’ˆ(í‚¤ë§/ìŠ¤í‹°ì»¤/í”„ë ˆì„)",
      category: "accessory",
      country: "ëŒ€í•œë¯¼êµ­",
      region: "ë¶€ì‚°",
      intro: "í¬í† ë¶€ìŠ¤ ì´¬ì˜ ê²½í—˜ì„ í™•ì¥í•˜ëŠ” í‚¤ë§/ìŠ¤í‹°ì»¤/í”„ë ˆì„ ì†Œí’ˆ ì†Œë¹„ê°€ ì¦ê°€.",
      why: "ê²½í—˜ ì†Œë¹„ + êµ¿ì¦ˆí™” + ì»¤í”Œ/ì¹œêµ¬ ì½˜í…ì¸ .",
      how: ["í¬í† ë¶€ìŠ¤ ì´¬ì˜ í›„ êµ¿ì¦ˆ ì¶”ê°€", "í‚¤ë§/ìŠ¤í‹°ì»¤ë¡œ ë‹¤ì´ì–´ë¦¬ ê¾¸ë¯¸ê¸°", "ê¸°ë…ì¼/ì„ ë¬¼ë¡œ í™œìš©"],
      buyUrl: "https://search.naver.com/search.naver?query=%ED%8F%AC%ED%86%A0%EB%B6%80%EC%8A%A4+%ED%82%A4%EB%A7%81",
      score: 69,
      updatedAt: daysAgo(8),
    },
    {
      id: "t8",
      title: "Global: í•˜ì´í¼íŒ/ëŒ„ìŠ¤ ì±Œë¦°ì§€(ì‹ ê³¡ ë°”ì´ëŸ´)",
      category: "music",
      country: "ê¸€ë¡œë²Œ",
      region: "ì˜¨ë¼ì¸",
      intro: "ì‹ ê³¡ì˜ í•˜ì´ë¼ì´íŠ¸ êµ¬ê°„ì´ ëŒ„ìŠ¤ ì±Œë¦°ì§€ë¡œ í¼ì§€ë©° í”Œë«í¼ì—ì„œ ê¸‰ìƒìŠ¹.",
      why: "ì•Œê³ ë¦¬ì¦˜ ì¶”ì²œ + ì§§ì€ í›„ë ´ êµ¬ê°„ + í¬ë¦¬ì—ì´í„° ì°¸ì—¬.",
      how: ["ì±Œë¦°ì§€ ë²„ì „ ì˜ìƒ ë³´ê¸°", "íŠœí† ë¦¬ì–¼ë¡œ ë”°ë¼í•˜ê¸°", "ë¦¬ë¯¹ìŠ¤/ì»¤ë²„ ì½˜í…ì¸  í™•ì¥"],
      buyUrl: "https://www.google.com/search?q=hyperpop+dance+challenge+trend",
      score: 88,
      updatedAt: daysAgo(1),
    },
    {
      id: "t9",
      title: "Italy: ì—ìŠ¤í”„ë ˆì†Œ í† ë‹‰(ì—¬ë¦„ í”„ë¦¬ë“œë§í¬)",
      category: "food",
      country: "ì´íƒˆë¦¬ì•„",
      region: "ë°€ë¼ë…¸",
      intro: "ì—ìŠ¤í”„ë ˆì†Œ+í† ë‹‰ì˜ ìŒ‰ì‹¸ë¦„/ì²­ëŸ‰ ì¡°í•©ì´ ì¹´í˜ì—ì„œ ì‹œê·¸ë‹ˆì²˜ë¡œ ë“±ì¥.",
      why: "ì»¤í”¼ ë¬¸í™” + ìƒˆë¡œìš´ ì‹ê°/ë§› + ê³„ì ˆì„±(ë”ìœ„).",
      how: ["ì¹´í˜ ì‹œê·¸ë‹ˆì²˜ë¡œ ì£¼ë¬¸", "ë ˆëª¬/í—ˆë¸Œë¡œ ë³€í˜•", "í™ˆì¹´í˜ ë ˆì‹œí”¼ ê³µìœ "],
      buyUrl: "https://www.google.com/search?q=espresso+tonic+italy+trend",
      score: 73,
      updatedAt: daysAgo(9),
    },
    {
      id: "t10",
      title: "USA: ë ˆíŠ¸ë¡œ ê²Œì„ ë‚˜ì´íŠ¸(ë³´ë“œ+ì½˜ì†” í˜¼í•©)",
      category: "culture",
      country: "ë¯¸êµ­",
      region: "LA",
      intro: "ì¹œêµ¬ë“¤ê³¼ ë³´ë“œê²Œì„+ë ˆíŠ¸ë¡œ ì½˜ì†”ì„ ì„ì–´ â€˜ê²Œì„ ë‚˜ì´íŠ¸â€™ ê²½í—˜ì„ ë§Œë“œëŠ” ë¬¸í™”.",
      why: "ì˜¤í”„ë¼ì¸ ì†Œì…œ íšŒê·€ + ë ˆíŠ¸ë¡œ ê°ì„± + ìŠ¤íŠ¸ë¦¬ë° ê³µìœ .",
      how: ["í…Œë§ˆë³„ ê²Œì„ ë‚˜ì´íŠ¸ ê¸°íš", "ìŠ¤ë‚µ/ìŒë£Œ í˜ì–´ë§", "ì‚¬ì§„/í´ë¦½ìœ¼ë¡œ ê³µìœ "],
      buyUrl: "https://www.google.com/search?q=retro+game+night+trend",
      score: 67,
      updatedAt: daysAgo(10),
    },
  ];

  const els = {
    chips: document.getElementById("categoryChips"),
    search: document.getElementById("search"),
    country: document.getElementById("country"),
    region: document.getElementById("region"),
    aiPickGrid: document.getElementById("aiPickGrid"),
    feedGrid: document.getElementById("feedGrid"),
    btnTheme: document.getElementById("btnTheme"),
    btnRefresh: document.getElementById("btnRefresh"),
    btnAbout: document.getElementById("btnAbout"),
    modalBack: document.getElementById("modalBack"),
    btnClose: document.getElementById("btnClose"),
    mTitle: document.getElementById("modalTitle"),
    mIntro: document.getElementById("mIntro"),
    mWhy: document.getElementById("mWhy"),
    mHow: document.getElementById("mHow"),
    mMeta: document.getElementById("mMeta"),
    mBuy: document.getElementById("mBuy"),
    mLearn: document.getElementById("mLearn"),
  };

  const state = {
    category: "all",
    search: "",
    country: "ì „ì²´",
    region: "ì „ì²´",
  };

  // ---- Init ----
  initTheme();
  renderCategoryChips();
  renderCountryOptions();
  renderRegionOptions();
  wireEvents();
  renderAll();

  // ---- UI / Rendering ----
  function renderCategoryChips(){
    els.chips.innerHTML = "";
    CATEGORIES.forEach(cat=>{
      const chip = document.createElement("div");
      chip.className = "chip";
      chip.textContent = cat.label;
      chip.dataset.key = cat.key;
      chip.dataset.active = (state.category === cat.key) ? "true" : "false";
      chip.addEventListener("click", ()=>{
        state.category = cat.key;
        updateActiveChips();
        renderRegionOptions(); // êµ­ê°€/ì§€ì—­ ì˜µì…˜ ì—…ë°ì´íŠ¸
        renderAll();
      });
      els.chips.appendChild(chip);
    });
  }

  function updateActiveChips(){
    [...els.chips.children].forEach(ch=>{
      ch.dataset.active = (ch.dataset.key === state.category) ? "true" : "false";
    });
  }

  function renderCountryOptions(){
    const countries = ["ì „ì²´", ...unique(trends.map(t=>t.country)).sort((a,b)=>a.localeCompare(b,"ko"))];
    els.country.innerHTML = countries.map(c=>`<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join("");
    els.country.value = state.country;
  }

  function renderRegionOptions(){
    const filteredByCountry = (state.country === "ì „ì²´")
      ? trends
      : trends.filter(t=>t.country === state.country);

    const regions = ["ì „ì²´", ...unique(filteredByCountry.map(t=>t.region)).sort((a,b)=>a.localeCompare(b,"ko"))];
    els.region.innerHTML = regions.map(r=>`<option value="${escapeHtml(r)}">${escapeHtml(r)}</option>`).join("");
    // í˜„ì¬ ì„ íƒ regionì´ ì˜µì…˜ì— ì—†ìœ¼ë©´ ì „ì²´ë¡œ
    if(!regions.includes(state.region)) state.region = "ì „ì²´";
    els.region.value = state.region;
  }

  function renderAll(){
    const filtered = applyFilters(trends, state);

    // AI ì¶”ì²œ(ê°€ìƒ): ì¹´í…Œê³ ë¦¬ë³„ ìƒìœ„ 1ê°œì”© + ì „ì²´ ìƒìœ„ 1ê°œ (ì¤‘ë³µ ì œê±°)
    const aiPicks = aiPick(filtered);
    renderGrid(els.aiPickGrid, aiPicks, { showAi: true });

    // í”¼ë“œ: ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ
    const sorted = [...filtered].sort((a,b)=> b.score - a.score);
    renderGrid(els.feedGrid, sorted, { showAi: false });

    // êµ­ê°€/ì§€ì—­ ì˜µì…˜ë„ ìµœì‹  ë°˜ì˜
    renderCountryOptions();
    renderRegionOptions();
  }

  function renderGrid(container, items, opts){
    container.innerHTML = "";
    if(items.length === 0){
      const empty = document.createElement("div");
      empty.className = "panel";
      empty.style.gridColumn = "1 / -1";
      empty.innerHTML = `
        <div class="bd" style="padding:16px">
          <div style="font-weight:1000; font-size:14px; margin-bottom:6px;">ê²°ê³¼ê°€ ì—†ì–´ìš”</div>
          <div style="color:var(--muted); font-weight:700; font-size:13px; line-height:1.5;">
            í•„í„°ë¥¼ ì™„í™”í•˜ê±°ë‚˜ í‚¤ì›Œë“œë¥¼ ë³€ê²½í•´ ë³´ì„¸ìš”.
          </div>
        </div>
      `;
      container.appendChild(empty);
      return;
    }

    items.forEach(item=>{
      const card = document.createElement("div");
      card.className = "card";
      card.setAttribute("role", "button");
      card.setAttribute("tabindex", "0");

      const isHot = item.score >= 80;
      const hotPill = isHot ? `<span class="pill hot">ğŸ”¥ HOT</span>` : ``;
      const aiPill = opts.showAi ? `<span class="pill ai">ğŸ¤– AI ì¶”ì²œ</span>` : ``;

      card.innerHTML = `
        <div class="meta">
          <span class="pill">${labelOfCategory(item.category)}</span>
          <span class="pill">${escapeHtml(item.country)} Â· ${escapeHtml(item.region)}</span>
          ${hotPill}
          ${aiPill}
        </div>
        <h3>${escapeHtml(item.title)}</h3>
        <p class="desc">${escapeHtml(item.intro)}</p>

        <div class="row">
          <div class="score">ë°˜ì‘ ì ìˆ˜: ${item.score} Â· ì—…ë°ì´íŠ¸: ${formatDate(item.updatedAt)}</div>
          <div class="miniBtns">
            <button class="mini" data-action="buy" title="ë§í¬ ì—´ê¸°">ë§í¬</button>
            <button class="mini primary" data-action="detail" title="ìƒì„¸ ë³´ê¸°">ìƒì„¸</button>
          </div>
        </div>
      `;

      // ì¹´ë“œ í´ë¦­: ìƒì„¸
      card.addEventListener("click", (e)=>{
        const btn = e.target.closest("button");
        if(btn){
          const action = btn.dataset.action;
          if(action === "buy"){
            window.open(item.buyUrl, "_blank", "noopener");
            e.stopPropagation();
            return;
          }
          if(action === "detail"){
            openModal(item);
            e.stopPropagation();
            return;
          }
        }else{
          openModal(item);
        }
      });

      card.addEventListener("keydown", (e)=>{
        if(e.key === "Enter" || e.key === " "){
          e.preventDefault();
          openModal(item);
        }
      });

      container.appendChild(card);
    });
  }

  // ---- Events ----
  function wireEvents(){
    els.search.addEventListener("input", ()=>{
      state.search = els.search.value.trim();
      renderAll();
    });
    els.country.addEventListener("change", ()=>{
      state.country = els.country.value;
      state.region = "ì „ì²´"; // êµ­ê°€ ë°”ê¾¸ë©´ ì§€ì—­ ì´ˆê¸°í™”
      renderRegionOptions();
      renderAll();
    });
    els.region.addEventListener("change", ()=>{
      state.region = els.region.value;
      renderAll();
    });

    els.btnTheme.addEventListener("click", toggleTheme);

    els.btnRefresh.addEventListener("click", ()=>{
      // ìƒ˜í”Œ ì ìˆ˜/ì—…ë°ì´íŠ¸ë¥¼ ì•½ê°„ ì„ì–´ì„œ "ìƒˆë¡œê³ ì¹¨ ëŠë‚Œ"ë§Œ ì£¼ê¸°
      trends = trends.map(t=>({
        ...t,
        score: clamp( Math.round(t.score + rand(-7, 7)), 40, 95 ),
        updatedAt: daysAgo( clamp(Math.round(rand(0, 12)), 0, 12) )
      }));
      renderAll();
    });

    els.btnAbout.addEventListener("click", ()=>{
      alert(
`TrendScope MVP v0.1

í˜„ì¬ êµ¬í˜„ëœ ê²ƒ:
- ì¹´í…Œê³ ë¦¬/êµ­ê°€/ì§€ì—­/í‚¤ì›Œë“œ í•„í„°
- AI ì¶”ì²œ(ê°€ìƒ ë¡œì§) ì„¹ì…˜
- ì¹´ë“œ/ìƒì„¸ ëª¨ë‹¬(ì†Œê°œ, ì†Œë¹„ë°©ë²•, ë§í¬)

ë‹¤ìŒ ë‹¨ê³„(ê¶Œì¥):
- ìˆ˜ì§‘: ë‰´ìŠ¤/SNS/ì»¤ë®¤ë‹ˆí‹° íŠ¸ë Œë“œ í¬ë¡¤ë§ ë˜ëŠ” API
- ì •ì œ: ì¤‘ë³µ ì œê±°, êµ­ê°€/ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜
- ìš”ì•½: LLMë¡œ "ì™œ ëœ¨ëŠ”ì§€/ì–´ë–»ê²Œ ì†Œë¹„" ìë™ ìƒì„±
- ë­í‚¹: ì¡°íšŒ/ì¢‹ì•„ìš”/ì–¸ê¸‰ëŸ‰/ì‹ ì„ ë„ ê¸°ë°˜ ìŠ¤ì½”ì–´ë§`
      );
    });

    // Modal close
    els.btnClose.addEventListener("click", closeModal);
    els.modalBack.addEventListener("click", (e)=>{
      if(e.target === els.modalBack) closeModal();
    });
    window.addEventListener("keydown", (e)=>{
      if(e.key === "Escape") closeModal();
    });
  }

  // ---- Modal ----
  function openModal(item){
    els.modalBack.dataset.open = "true";
    els.modalBack.setAttribute("aria-hidden", "false");

    els.mTitle.textContent = item.title;
    els.mIntro.textContent = item.intro;
    els.mWhy.textContent = item.why;
    els.mHow.innerHTML = item.how.map(x=>`<li>${escapeHtml(x)}</li>`).join("");
    els.mMeta.textContent =
      `${labelOfCategory(item.category)} Â· ${item.country} Â· ${item.region} Â· ë°˜ì‘ ì ìˆ˜ ${item.score} Â· ì—…ë°ì´íŠ¸ ${formatDate(item.updatedAt)}`;

    els.mBuy.href = item.buyUrl || "#";
    const q = encodeURIComponent(`${item.title} ${item.country} ${item.region}`);
    els.mLearn.href = `https://www.google.com/search?q=${q}`;
  }

  function closeModal(){
    els.modalBack.dataset.open = "false";
    els.modalBack.setAttribute("aria-hidden", "true");
  }

  // ---- Filtering / AI Picks ----
  function applyFilters(items, st){
    const kw = st.search.toLowerCase();
    return items.filter(t=>{
      const okCat = (st.category === "all") ? true : t.category === st.category;
      const okCountry = (st.country === "ì „ì²´") ? true : t.country === st.country;
      const okRegion = (st.region === "ì „ì²´") ? true : t.region === st.region;
      const hay = `${t.title} ${t.intro} ${t.why} ${t.country} ${t.region}`.toLowerCase();
      const okKw = kw ? hay.includes(kw) : true;
      return okCat && okCountry && okRegion && okKw;
    });
  }

  function aiPick(filtered){
    // ì¹´í…Œê³ ë¦¬ë³„ top1 + ì „ì²´ top1
    const picks = [];
    const byCat = {};
    filtered.forEach(t=>{
      if(!byCat[t.category]) byCat[t.category] = [];
      byCat[t.category].push(t);
    });

    Object.keys(byCat).forEach(cat=>{
      byCat[cat].sort((a,b)=> b.score - a.score);
      picks.push(byCat[cat][0]);
    });

    // ì „ì²´ top
    const topAll = [...filtered].sort((a,b)=> b.score - a.score)[0];
    if(topAll) picks.push(topAll);

    // ì¤‘ë³µ ì œê±°
    const uniq = [];
    const seen = new Set();
    for(const p of picks){
      if(p && !seen.has(p.id)){
        seen.add(p.id);
        uniq.push(p);
      }
    }
    // ë„ˆë¬´ ë§ìœ¼ë©´ 6ê°œë¡œ ì œí•œ
    return uniq.slice(0, 6);
  }

  // ---- Theme ----
  function initTheme(){
    const saved = localStorage.getItem("trendScopeTheme");
    if(saved === "light" || saved === "dark"){
      document.documentElement.dataset.theme = saved;
    }else{
      document.documentElement.dataset.theme = "dark";
    }
  }
  function toggleTheme(){
    const now = document.documentElement.dataset.theme === "light" ? "dark" : "light";
    document.documentElement.dataset.theme = now;
    localStorage.setItem("trendScopeTheme", now);
  }

  // ---- Utils ----
  function unique(arr){ return [...new Set(arr.filter(Boolean))]; }
  function labelOfCategory(key){
    const hit = CATEGORIES.find(c=>c.key === key);
    return hit ? hit.label : key;
  }
  function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }
  function rand(a,b){ return Math.random() * (b-a) + a; }
  function daysAgo(n){
    const d = new Date();
    d.setDate(d.getDate() - n);
    return d.toISOString();
  }
  function formatDate(iso){
    try{
      const d = new Date(iso);
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,"0");
      const dd = String(d.getDate()).padStart(2,"0");
      return `${y}-${m}-${dd}`;
    }catch(_){
      return "-";
    }
  }
  function escapeHtml(str){
    return String(str ?? "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }
</script>
</body>
</html>
